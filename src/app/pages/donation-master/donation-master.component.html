<div class="page-header">
  <div class="page-title">
    <div class="page-title-icon"><i class="pi pi-heart"></i></div>
    <div><h2>Donation Master</h2><p>Manage donation types</p></div>
  </div>
  <button pButton class="btn btn-primary" icon="pi pi-plus" label="Add Donation Type" (click)="showForm = !showForm"></button>
</div>

@if (showForm) {
  <div class="card">
    <div class="card-header"><h3><i class="pi pi-file-edit"></i> Donation Type Details</h3></div>
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="save()">
        <div class="form-row">
          <div class="form-group">
            <label>Donation Type <span class="required">*</span></label>
            <input pInputText class="form-control" formControlName="donationType">
            @if (form.controls.donationType.invalid && form.controls.donationType.touched) {
              <div class="field-error">Donation type is required.</div>
            }
          </div>
          <div class="form-group"><label>Description</label><input pInputText class="form-control" formControlName="description"></div>
          <div class="form-group"><label>Status</label><p-select [appendTo]="'body'" [filter]="true" [options]="statusOptions" formControlName="status" class="form-control"></p-select></div>
        </div>
        <div class="btn-group">
          <button pButton class="btn btn-primary" type="submit" icon="pi pi-save" label="Save" [loading]="isSaving" [disabled]="isSaving"></button>
          <button pButton class="btn btn-secondary" type="button" icon="pi pi-times" label="Cancel" (click)="showForm = false"></button>
        </div>
        @if (formMessage) {
          <div class="form-notice success">{{ formMessage }}</div>
        }
        @if (formError) {
          <div class="form-notice error">{{ formError }}</div>
        }
      </form>
    </div>
  </div>
}

<div class="card">
  <div class="card-header">
    <h3><i class="pi pi-list"></i> Donation Types</h3>
    <div class="table-actions">
      <button pButton class="btn btn-secondary" icon="pi pi-file-excel" label="Excel" (click)="exportExcel()"></button>
      <button pButton class="btn btn-secondary" icon="pi pi-file-pdf" label="PDF" (click)="exportPdf()"></button>
      <button pButton class="btn btn-secondary" icon="pi pi-print" label="Print" (click)="printTable()"></button>
    </div>
  </div>
  <div class="card-body table-wrap">
    <p-table [value]="donationTypes" styleClass="data-table">
      <ng-template pTemplate="header"><tr><th>S.No</th><th>Type</th><th>Description</th><th>Status</th><th>Status Action</th></tr></ng-template>
      <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
        <tr>
          <td>{{ rowIndex + 1 }}</td>
          <td>{{ item.donationType }}</td>
          <td>{{ item.description }}</td>
          <td><p-tag [value]="item.status" [severity]="item.status === 'Active' ? 'success' : 'danger'"></p-tag></td>
          <td>
            <button
              pButton
              class="p-button-sm"
              [class.p-button-danger]="item.status === 'Active'"
              [class.p-button-success]="item.status === 'Inactive'"
              [label]="item.status === 'Active' ? 'Set Inactive' : 'Set Active'"
              (click)="toggleStatus(item)"
              aria-label="Toggle donation type status">
            </button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

